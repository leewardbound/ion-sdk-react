(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return IonContext})),__webpack_require__.d(__webpack_exports__,"d",(function(){return Ion_useIon})),__webpack_require__.d(__webpack_exports__,"a",(function(){return Broadcast.a})),__webpack_require__.d(__webpack_exports__,"c",(function(){return Broadcast.b}));var react=__webpack_require__(0),react_default=__webpack_require__.n(react),IonContext=react_default.a.createContext(null),Ion_useIon=function useIon(){return react_default.a.useContext(IonContext)},Broadcast=__webpack_require__(214)},140:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return VideoView}));__webpack_require__(5),__webpack_require__(17),__webpack_require__(4),__webpack_require__(8),__webpack_require__(309);var react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function VideoView(_ref){var stream=_ref.stream,props=_objectWithoutProperties(_ref,["stream"]),videoRef=react__WEBPACK_IMPORTED_MODULE_5___default.a.useRef();return react__WEBPACK_IMPORTED_MODULE_5___default.a.useEffect((function(){stream&&videoRef.current&&setTimeout((function(){videoRef.current.srcObject=stream}),500)}),[stream]),react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("video",_extends({ref:videoRef,onCanPlay:function onCanPlay(){videoRef.current.play()},autoPlay:!0,playsInline:!0},props))}VideoView.displayName="VideoView",VideoView.__docgenInfo={description:"",methods:[],displayName:"VideoView"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/VideoView/index.js"]={name:"VideoView",docgenInfo:VideoView.__docgenInfo,path:"src/components/VideoView/index.js"})},1440:function(module,exports,__webpack_require__){"use strict";__webpack_require__(5),__webpack_require__(51),__webpack_require__(46),__webpack_require__(44),__webpack_require__(41),__webpack_require__(1441),__webpack_require__(1442),__webpack_require__(8),__webpack_require__(48);var _clientApi=__webpack_require__(61),_clientLogger=__webpack_require__(40),_configFilename=__webpack_require__(1443);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}(_configFilename.args||_configFilename.argTypes)&&_clientLogger.logger.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify({args:_configFilename.args,argTypes:_configFilename.argTypes})),_configFilename.decorators&&_configFilename.decorators.forEach((function(decorator){return(0,_clientApi.addDecorator)(decorator,!1)})),(_configFilename.parameters||_configFilename.globals||_configFilename.globalTypes)&&(0,_clientApi.addParameters)(_objectSpread(_objectSpread({},_configFilename.parameters),{},{globals:_configFilename.globals,globalTypes:_configFilename.globalTypes}),!1),_configFilename.argTypesEnhancers&&_configFilename.argTypesEnhancers.forEach((function(enhancer){return(0,_clientApi.addArgTypesEnhancer)(enhancer)}))},1443:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"parameters",(function(){return parameters}));var parameters={actions:{argTypesRegex:"^on[A-Z].*"}}},1444:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(397).configure)([__webpack_require__(1445),__webpack_require__(1446)],module,!1)}).call(this,__webpack_require__(113)(module))},1445:function(module,exports){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,module.exports=webpackEmptyContext,webpackEmptyContext.id=1445},1446:function(module,exports,__webpack_require__){var map={"./stories/BroadcastPreview.stories.js":1447,"./stories/IonProvider.stories.js":1451,"./stories/SimplePeer.stories.js":1460};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1446},1447:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Preview",(function(){return Preview}));__webpack_require__(159),__webpack_require__(4);var react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(88);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}__webpack_exports__.default={title:"BroadcastPreview",component:_components__WEBPACK_IMPORTED_MODULE_3__.a};var Template=function Template(args){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_components__WEBPACK_IMPORTED_MODULE_3__.b,{debug:!0},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_components__WEBPACK_IMPORTED_MODULE_3__.a,_extends({width:400},args)))};Template.displayName="Template";var Preview=Template.bind({});Preview.args={},Preview.parameters=Object.assign({storySource:{source:"(args) => <BroadcastProvider debug>\n  <BroadcastPreview width={400} {...args} />\n</BroadcastProvider>"}},Preview.parameters)},1451:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"JSONRPC",(function(){return JSONRPC}));__webpack_require__(159),__webpack_require__(4);var react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(88);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}__webpack_exports__.default={title:"IonProvider",component:_components__WEBPACK_IMPORTED_MODULE_3__.c};var Template=function Template(args){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_components__WEBPACK_IMPORTED_MODULE_3__.c,_extends({debug:!0},args))};Template.displayName="Template";var JSONRPC=Template.bind({});JSONRPC.args={},JSONRPC.parameters=Object.assign({storySource:{source:"(args) => <IonProvider debug {...args} />"}},JSONRPC.parameters)},1460:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"OnePeer",(function(){return OnePeer})),__webpack_require__.d(__webpack_exports__,"BuddyTest",(function(){return BuddyTest}));__webpack_require__(5),__webpack_require__(10),__webpack_require__(20),__webpack_require__(1452),__webpack_require__(26),__webpack_require__(17),__webpack_require__(14),__webpack_require__(15),__webpack_require__(22),__webpack_require__(13),__webpack_require__(21),__webpack_require__(159),__webpack_require__(6),__webpack_require__(4),__webpack_require__(8),__webpack_require__(12),__webpack_require__(18),__webpack_require__(16),__webpack_require__(19);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),createMuiTheme=__webpack_require__(525),ThemeProvider=__webpack_require__(1483),components=__webpack_require__(88),theme=Object(createMuiTheme.a)({});function StoryProvider(_ref){var children=_ref.children,debug=_ref.debug,localStream=_ref.localStream,address=_ref.address,room=_ref.room,signal=_ref.signal;return react_default.a.createElement(components.c,{debug:debug,address:address,room:room,signal:signal},react_default.a.createElement(components.b,{stream:localStream},react_default.a.createElement(ThemeProvider.a,{theme:theme},children)))}StoryProvider.displayName="StoryProvider",StoryProvider.__docgenInfo={description:"",methods:[],displayName:"StoryProvider"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/stories/StoryProvider.js"]={name:"StoryProvider",docgenInfo:StoryProvider.__docgenInfo,path:"src/stories/StoryProvider.js"});__webpack_require__(23),__webpack_require__(41);var Card=__webpack_require__(1486),contexts=__webpack_require__(110),CardHeader=__webpack_require__(1485),VideoView=__webpack_require__(140);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function SimplePeer(_ref){var debug=_ref.debug,publish=_ref.publish,subscribe=_ref.subscribe,peerStreams=_ref.peerStreams,setPeerStreams=_ref.setPeerStreams,_useIon=Object(contexts.d)(),client=_useIon.client,address=_useIon.address,connectionState=_useIon.connectionState,signalingState=_useIon.signalingState,_React$useState2=_slicedToArray(react_default.a.useState(""),2),peerState=_React$useState2[0],setPeerState=_React$useState2[1],_useBroadcast=Object(contexts.c)(),localStream=_useBroadcast.localStream,getUserMedia=_useBroadcast.getUserMedia,_React$useState4=_slicedToArray(react_default.a.useState("SimplePeer ".concat(Math.ceil(100*Math.random()))),2),name=_React$useState4[0],_React$useState6=(_React$useState4[1],_slicedToArray(react_default.a.useState({}),2)),tracks=_React$useState6[0],setTracks=_React$useState6[1],_React$useState8=_slicedToArray(react_default.a.useState({}),2),trackStreams=_React$useState8[0],setTrackStreams=_React$useState8[1];return react_default.a.useEffect((function(){!publish||localStream&&localStream.stream||getUserMedia()}),[localStream]),react_default.a.useEffect((function SetupPeer(){client&&"stable"===signalingState&&""===peerState&&localStream&&(client.ontrack=function(track,stream){console.log("Got track",track),setTracks((function(previous){return Object.assign({},previous,_defineProperty({},track.id,track))})),setTrackStreams((function(previous){return Object.assign({},previous,_defineProperty({},track.id,stream))}))},localStream&&publish&&(console.log("Publishing",localStream),setPeerState("publishing"),client.publish(localStream),setPeerStreams((function(ps){return Object.assign({},ps,_defineProperty({},localStream.stream.id,name))}))))}),[client,peerState,signalingState,localStream]),react_default.a.useEffect((function(){return function Cleanup(){var _localStream$stream;client&&(console.log("cleaning up"),ion.client.close(),(null==localStream||null===(_localStream$stream=localStream.stream)||void 0===_localStream$stream?void 0:_localStream$stream.id)&&setPeerStreams((function(orig){return Object.assign({},orig,_defineProperty({},localStream.stream.id,null))})))}}),[]),react_default.a.createElement(Card.a,null,react_default.a.createElement(CardHeader.a,{title:name,subheader:debug?"".concat(peerState," (").concat(address,": ").concat(connectionState,", ").concat(signalingState,")"):null}),Object.keys(tracks).map((function(id){var stream=trackStreams[id],name=peerStreams[null==stream?void 0:stream.id];return stream&&subscribe&&null!==name?react_default.a.createElement(SimplePeer_ShowTrack,{key:id,track:tracks[id],stream:stream,name:name,debug:debug}):null})))}SimplePeer.displayName="SimplePeer";var SimplePeer_ShowTrack=function ShowTrack(_ref2){var track=_ref2.track,stream=_ref2.stream,name=_ref2.name,debug=_ref2.debug;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("h6",null,name," ",debug?"- Track ".concat(track.id):null),react_default.a.createElement(VideoView.a,{stream:stream,width:300}))};SimplePeer.defaultProps={publish:!0,subscribe:!0},SimplePeer.__docgenInfo={description:"",methods:[],displayName:"SimplePeer",props:{publish:{defaultValue:{value:"true",computed:!1},required:!1},subscribe:{defaultValue:{value:"true",computed:!1},required:!1}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/stories/SimplePeer.js"]={name:"SimplePeer",docgenInfo:SimplePeer.__docgenInfo,path:"src/stories/SimplePeer.js"});var Grid=__webpack_require__(1484);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function SimplePeer_stories_slicedToArray(arr,i){return function SimplePeer_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function SimplePeer_stories_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function SimplePeer_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return SimplePeer_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SimplePeer_stories_arrayLikeToArray(o,minLen)}(arr,i)||function SimplePeer_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SimplePeer_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Simple Peer",component:SimplePeer};var SimplePeer_stories_PeerTemplate=function PeerTemplate(_ref){var count=_ref.count,args=_objectWithoutProperties(_ref,["count"]),_React$useState2=SimplePeer_stories_slicedToArray(react_default.a.useState("room-".concat(Math.ceil(100*Math.random()))),2),room=_React$useState2[0],_React$useState4=(_React$useState2[1],SimplePeer_stories_slicedToArray(react_default.a.useState({}),2)),peerStreams=_React$useState4[0],setPeerStreams=_React$useState4[1],num=null===count?1:count;return react_default.a.createElement(Grid.a,{container:!0},react_default.a.createElement(Grid.a,{item:!0,xs:12},react_default.a.createElement("h4",null,"Room: ",room)),Array(num).fill(num).map((function(_){return react_default.a.createElement(Grid.a,{item:!0,md:6},react_default.a.createElement(StoryProvider,{room:room},react_default.a.createElement(SimplePeer,_extends({},args,{peerStreams:peerStreams,setPeerStreams:setPeerStreams}))))})))};SimplePeer_stories_PeerTemplate.displayName="PeerTemplate";var OnePeer=SimplePeer_stories_PeerTemplate.bind({});OnePeer.args={debug:!0};var BuddyTest=SimplePeer_stories_PeerTemplate.bind({});BuddyTest.args={debug:!0,count:2},OnePeer.parameters=Object.assign({storySource:{source:"({ count, ...args }) => {\n  const [room, setRoom] = React.useState(\n    `room-${Math.ceil(Math.random() * 100)}`\n  );\n  const [peerStreams, setPeerStreams] = React.useState({})\n  const num = count === null ? 1 : count\n  return (\n    <Grid container>\n      <Grid item xs={12}>\n        <h4>Room: {room}</h4>\n      </Grid>\n      {Array(num).fill(num).map(_ => (\n        <Grid item md={6}>\n        <StoryProvider room={room}>\n          <SimplePeer {...args} peerStreams={peerStreams} setPeerStreams={setPeerStreams} />\n        </StoryProvider>\n        </Grid>\n      ))}\n    </Grid>\n  );\n}"}},OnePeer.parameters),BuddyTest.parameters=Object.assign({storySource:{source:"({ count, ...args }) => {\n  const [room, setRoom] = React.useState(\n    `room-${Math.ceil(Math.random() * 100)}`\n  );\n  const [peerStreams, setPeerStreams] = React.useState({})\n  const num = count === null ? 1 : count\n  return (\n    <Grid container>\n      <Grid item xs={12}>\n        <h4>Room: {room}</h4>\n      </Grid>\n      {Array(num).fill(num).map(_ => (\n        <Grid item md={6}>\n        <StoryProvider room={room}>\n          <SimplePeer {...args} peerStreams={peerStreams} setPeerStreams={setPeerStreams} />\n        </StoryProvider>\n        </Grid>\n      ))}\n    </Grid>\n  );\n}"}},BuddyTest.parameters)},214:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BroadcastContext})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useBroadcast}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),BroadcastContext=react__WEBPACK_IMPORTED_MODULE_0___default.a.createContext(),useBroadcast=function useBroadcast(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.useContext(BroadcastContext)}},527:function(module,exports,__webpack_require__){__webpack_require__(528),__webpack_require__(676),__webpack_require__(677),__webpack_require__(831),__webpack_require__(1386),__webpack_require__(1419),__webpack_require__(1424),__webpack_require__(1436),__webpack_require__(1438),__webpack_require__(1440),module.exports=__webpack_require__(1444)},592:function(module,exports){},677:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(397)},88:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return components_IonProvider})),__webpack_require__.d(__webpack_exports__,"b",(function(){return components_BroadcastProvider})),__webpack_require__.d(__webpack_exports__,"a",(function(){return BroadcastPreview}));__webpack_require__(5),__webpack_require__(10),__webpack_require__(20),__webpack_require__(23),__webpack_require__(26),__webpack_require__(14),__webpack_require__(15),__webpack_require__(13),__webpack_require__(21),__webpack_require__(6),__webpack_require__(4),__webpack_require__(12),__webpack_require__(18),__webpack_require__(16),__webpack_require__(19);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),lib=__webpack_require__(142),contexts=__webpack_require__(110);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function IonConnectionStatus(){var _useIon=Object(contexts.d)(),connectionState=_useIon.connectionState,signalingState=_useIon.signalingState,address=_useIon.address;return react_default.a.createElement("div",null,address||"Ion"," Status: ",connectionState&&signalingState?"".concat(connectionState,", ").concat(signalingState):"unknown!")}function IonProvider(_ref){var _ion$client,_ion$client$pc,_ion$client2,_ion$client2$pc,children=_ref.children,signal=_ref.signal,address=_ref.address,room=_ref.room,debug=_ref.debug,_React$useState2=_slicedToArray(react_default.a.useState({client:null}),2),ion=_React$useState2[0],setIon=_React$useState2[1],connectionState=null===(_ion$client=ion.client)||void 0===_ion$client||null===(_ion$client$pc=_ion$client.pc)||void 0===_ion$client$pc?void 0:_ion$client$pc.connectionState,signalingState=null===(_ion$client2=ion.client)||void 0===_ion$client2||null===(_ion$client2$pc=_ion$client2.pc)||void 0===_ion$client2$pc?void 0:_ion$client2$pc.signalingState;return react_default.a.useEffect((function(){ion.client&&ion.client.pc&&setIon((function(_old){return Object.assign({},_old,{connectionState:connectionState,signalingState:signalingState})}))}),[connectionState,signalingState]),react_default.a.useEffect((function(){return function ConnectIon(){ion.client&&ion.client.close(),setIon(signal?{client:new lib.Client(room,signal),address:address,room:room}:{address:address||"ws://localhost:7000/ws",room:room,client:new lib.Client(room,new lib.IonSFUJSONRPCSignal(address||"ws://localhost:7000/ws"))})}(),function Cleanup(){ion.client&&(console.log("cleaning up"),ion.client.close())}}),[room,address]),react_default.a.createElement(contexts.b.Provider,{value:ion},children,!0===debug?react_default.a.createElement(IonConnectionStatus,null):debug)}IonConnectionStatus.displayName="IonConnectionStatus",IonProvider.displayName="IonProvider",IonConnectionStatus.__docgenInfo={description:"",methods:[],displayName:"IonConnectionStatus"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/IonProvider/IonProvider.js"]={name:"IonConnectionStatus",docgenInfo:IonConnectionStatus.__docgenInfo,path:"src/components/IonProvider/IonProvider.js"}),IonProvider.__docgenInfo={description:"",methods:[],displayName:"IonProvider"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/IonProvider/IonProvider.js"]={name:"IonProvider",docgenInfo:IonProvider.__docgenInfo,path:"src/components/IonProvider/IonProvider.js"});var components_IonProvider=IonProvider;__webpack_require__(134),__webpack_require__(143);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function BroadcastProvider_slicedToArray(arr,i){return function BroadcastProvider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function BroadcastProvider_iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function BroadcastProvider_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return BroadcastProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BroadcastProvider_arrayLikeToArray(o,minLen)}(arr,i)||function BroadcastProvider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function BroadcastProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function BroadcastProvider(_ref){var children=_ref.children,stream=_ref.stream,audio=_ref.audio,video=_ref.video,simulcast=_ref.simulcast,options=_ref.options,_React$useState2=BroadcastProvider_slicedToArray(react_default.a.useState({audio:audio,video:video,simulcast:simulcast}),2),constraints=_React$useState2[0],setContstraints=_React$useState2[1],_React$useState4=BroadcastProvider_slicedToArray(react_default.a.useState(stream),2),localStream=_React$useState4[0],setLocalStream=_React$useState4[1];function _getUserMedia(){return(_getUserMedia=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var attached;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return console.debug("getUserMedia",constraints,options),_context.next=3,lib.LocalStream.getUserMedia(constraints,options);case 3:return attached=_context.sent,setLocalStream(attached),_context.abrupt("return",attached);case 6:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}var broadcast={constraints:constraints,setContstraints:setContstraints,getUserMedia:function getUserMedia(){return _getUserMedia.apply(this,arguments)},setLocalStream:setLocalStream,localStream:localStream};return react_default.a.createElement(contexts.a.Provider,{value:broadcast},children)}BroadcastProvider.displayName="BroadcastProvider",BroadcastProvider.__docgenInfo={description:"",methods:[],displayName:"BroadcastProvider"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/BroadcastProvider/BroadcastProvider.js"]={name:"BroadcastProvider",docgenInfo:BroadcastProvider.__docgenInfo,path:"src/components/BroadcastProvider/BroadcastProvider.js"});var components_BroadcastProvider=BroadcastProvider;function BroadcastControls(){return react_default.a.createElement(react_default.a.Fragment,null,"Controls")}BroadcastControls.__docgenInfo={description:"",methods:[],displayName:"BroadcastControls"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/BroadcastControls/BroadcastControls.js"]={name:"BroadcastControls",docgenInfo:BroadcastControls.__docgenInfo,path:"src/components/BroadcastControls/BroadcastControls.js"});var Broadcast=__webpack_require__(214),VideoView=__webpack_require__(140);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function BroadcastPreview(props){var _useBroadcast=Object(Broadcast.b)(),localStream=_useBroadcast.localStream,getUserMedia=_useBroadcast.getUserMedia;return react_default.a.useEffect((function(){localStream&&localStream.stream||getUserMedia()}),[]),localStream&&localStream.stream?react_default.a.createElement(VideoView.a,_extends({stream:localStream.stream},props)):react_default.a.createElement(react_default.a.Fragment,null,"Requesting video...")}BroadcastPreview.__docgenInfo={description:"",methods:[],displayName:"BroadcastPreview"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/BroadcastControls/BroadcastPreview.js"]={name:"BroadcastPreview",docgenInfo:BroadcastPreview.__docgenInfo,path:"src/components/BroadcastControls/BroadcastPreview.js"})}},[[527,1,2]]]);
//# sourceMappingURL=main.3b94b620e19aacab0c2e.bundle.js.map